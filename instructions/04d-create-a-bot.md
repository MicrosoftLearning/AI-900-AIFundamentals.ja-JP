---
lab:
  title: 質問応答について調べる
---

# <a name="explore-question-answering"></a>質問応答について調べる

> **注** このラボを完了するには、管理者アクセス権が与えられている [Azure サブスクリプション](https://azure.microsoft.com/free?azure-portal=true)が必要です。

カスタマー サポート のシナリオでは、Web サイトのチャット ウィンドウ、電子メール、または音声インターフェイスを使用して、よく寄せられる質問を解釈して回答できるボットを作成するのが一般的です。 ボット インターフェイスの基になるのは、ボットが適切な応答を検索できる質問と適切な回答のナレッジ ベースです。

## <a name="create-a-custom-question-answering-knowledge-base"></a>カスタム質問応答ナレッジ ベースを作成する

言語サービスの質問応答機能を使用すると、質問と回答のペアを入力するか、既存のドキュメントまたは Web ページからナレッジ ベースをすばやく作成できます。 その後、組み込みの自然言語処理機能を使用して、質問を解釈し、適切な回答を見つけ出します。

1. Azure portal ([https://portal.azure.com](https://portal.azure.com?azure-portal=true)) を開き、Microsoft アカウントでサインインします。

1. **[&#65291;リソースの作成]** ボタンをクリックして、"言語サービス" を検索し、次の設定を使用して**言語サービス リソース**を作成します。 **[リソースの作成を続行する]** 、 **[追加機能の選択]** の順にクリックします。**
    - **既定の機能**: "既定の機能はそのままにしておきます" **
    - **カスタム機能**: "カスタム質問応答を選択します"。**

    ![カスタム質問応答を有効にした言語サービス リソースの作成。](media/create-a-bot/create-language-service-resource.png)

1. **[言語の作成]** ページで、次の設定を指定します。
    - **[サブスクリプション]**: *お使いの Azure サブスクリプション*。
    - **[リソース グループ]**: 既存のリソース グループを選択するか、新しいリソース グループを作成します。**
    - **名前**: "言語リソースの一意の名前"。**
    - **価格レベル**: S (1 分あたり 1,000 通話)
    - **Azure Search のリージョン**: "使用可能な任意の場所"。**
    - **Azure Search の価格レベル**: Free F (3 インデックス) ("このレベルを使用できない場合は、Standard S (50 インデックス) を選択します")**
    - **このボックスをオンにすることで、責任ある AI 通知の条項を承認し、同意したことを確認します**: "選択済み"。**

    > **注** 無料レベルの **Azure Cognitive Search** リソースを既にプロビジョニングしてある場合は、クォータにより、別のリソースを作成できない場合があります。 その場合は、**Free F** 以外のレベルを選択します。

1. **[確認と作成]**、**[作成]** の順にクリックします。 カスタム質問応答ナレッジ ベースをサポートする言語サービスがデプロイされるのを待ちます。

1. 新しいブラウザー タブで Language Studio ポータル ([https://language.azure.com](https://language.azure.com?azure-portal=true)) を開き、ご利用の Azure サブスクリプションに関連付けられている Microsoft アカウントを使ってサインインします。

1. 言語リソースの選択を求めるメッセージが表示されたら、次の設定を選択します。
    - **Azure ディレクトリ**: お使いのサブスクリプションを含む Azure ディレクトリ。
    - **Azure サブスクリプション**: ご利用の Azure サブスクリプション
    - **言語リソース**: 先ほど作成した言語リソース。

1. 言語リソースの選択を求めるメッセージが表示***されない***場合、原因として、お使いのサブスクリプションに複数の言語リソースが存在していることが考えられます。その場合は、次の操作を行います。
    1. ページの上部にあるバーで、**[設定] (&#9881;)** ボタンをクリックします。
    2. **[設定]** ページで、**[リソース]** タブを表示します。
    3. 作成したばかりの言語リソースを選択し、**[リソースの切り替え]** をクリックします。
    4. ページの上部で、**[Language Studio]** をクリックして、Language Studio のホーム ページに戻ります。

1. Language Studio ポータルの上部にある **[新規作成]** メニューで、**[カスタム質問応答]** を選択します。

1. **[リソース (お使いのリソース) の言語設定を選択する]** ページで、 **[このリソースでプロジェクトを作成するときに言語を選択する]** を選択し、 **[次へ]** をクリックします。**

1. **[基本情報の入力]** ページで、次の詳細を入力し、**[次へ]** をクリックします。
    - **言語リソース**: "お使いの言語リソースを選択します"。**  
    - **Azure Search リソース**: "お使いの Azure Search リソースを選択します"。**
    - **名前**: MargiesTravel
    - **説明**: 簡単なナレッジ ベース
    - **ソース言語**: 英語
    - **回答が返されない場合の既定の回答**: 回答が見つかりませんでした

1. **[確認と終了]** ページで、**[プロジェクトの作成]** をクリックします。

1. **[ソースの管理]** ページが表示されます。 **[&#65291;ソースの追加]** をクリックし、**[URL]** を選択します。

1. **[URL の追加]** ボックスで、 **[URL の追加]** をクリックします。 次のように入力し、 **[すべて追加]** を選択します。
    - **URL 名**: MargiesKB
    - **URL**: `https://raw.githubusercontent.com/MicrosoftLearning/AI-900-AIFundamentals/main/data/qna/margies_faq.docx`
    - **ファイル構造の分類**: "自動検出"** 

## <a name="edit-the-knowledge-base"></a>ナレッジ ベースを編集する

ナレッジ ベースは、FAQ ドキュメントの詳細と事前定義の応答に基づいて作成されます。 カスタムの質問と回答のペアを追加して、これらを補完することができます。

1. 左側のパネルで、**[ナレッジ ベースの編集]** をクリックします。 次に、**[+ 質問のペアの追加]** をクリックします。

1. **[質問]** ボックスに 「`Hello`」と入力し、 **[変更の送信]** をクリックします。

1. **[代替フレーズの追加]** をクリックし、「`Hi`」と入力し、 **[変更の送信]** をクリックします。

1. **[回答とプロンプト]** ボックスに「****」と入力します。 **[ソース]** は [編集] のままにしておきます。

1. **[送信]** をクリックします。 次に、ページの上部にある **[変更の保存]** をクリックします。 ボタンを表示するには、ウィンドウのサイズを変更しなければならない場合があります。

## <a name="train-and-test-the-knowledge-base"></a>ナレッジ ベースのトレーニングとテスト

ナレッジ ベースが作成されたので、それをテストできます。

1. ナレッジ ベースをテストするには、ページの上部にある **[テスト]** をクリックします。

1. テスト ペインの下部にメッセージ 「*Hi*」 を入力すると、 
              応答「**Hello**」が返されるはずです。

1. テスト ペインの下部に *フライトを予約したい* というメッセージを入力します。 FAQ から適切な応答が返されるはずです。

    > **注** 応答には、"短い回答" とより詳細な "回答文節" が含まれています。回答文節には、最も一致する質問の FAQ ドキュメントの全文が表示され、短い回答は文節からインテリジェントに抽出されます。** ** テスト ペインの上部にある **[短い回答を表示する]** チェック ボックスを使用して、応答から短い回答を得るかどうかを制御できます。

1. 
              「*予約をキャンセルする方法は？*」などの別の質問を試してみてください。

1. ナレッジ ベースのテストが完了したら、**[テスト]** をクリックしてテスト ペインを閉じます。

## <a name="create-a-bot-for-the-knowledge-base"></a>ナレッジ ベース用のボットを作成する

ナレッジ ベースでは、クライアント アプリケーションが何らかの種類のユーザー インターフェイスを介して質問に回答するために使用できるバック エンド サービスが提供されます。 一般に、これらのクライアント アプリケーションはボットです。 ナレッジ ベースをボットで使用するには、HTTP を使用してアクセスできるサービスとして公開する必要があります。 次に、Azure Bot Service を使用して、ナレッジ ベースを使用してユーザーの質問に回答するボットを作成およびホストできます。

1. Language Studio ページの左側にある **[ナレッジ ベースのデプロイ]** をクリックします。

1. ページの上部にある **[デプロイ]** をクリックし、もう一度 **[デプロイ]** をクリックします。

1. サービスがデプロイされたら、 **[ボットの作成]** をクリックします。 これにより、Azure portal が新しいブラウザー タブで開き、お使いの Azure サブスクリプションで Web アプリ ボットを作成できます。

1. Azure portal で、次の設定で Web アプリ ボットを作成します (ほとんどの設定は事前入力されています)。
    - **[ボット ハンドル]**: *ボットの一意の名前*
    - **[サブスクリプション]**:"*ご自身の Azure サブスクリプション*"
    - **[リソース グループ]** : "*言語リソースを含むリソース グループ*"
    - **[場所]**: *言語サービスと同じ場所*。
    - **価格レベル**: Free F0
    - **[アプリ名]**: ***ボット ハンドル**と同じ名前に **.azurewebsites.net** が自動的に付加されます*
    - **[SDK 言語]**: *C# または Node.js を選択します*
    - **言語リソース キー**: * は自動生成されます。表示されない場合は、Language Studio で質問応答プロジェクトを作成することから始める必要があります* 
    - **App Service プラン/場所**: *矢印を選択して計画を作成します。次に、一意のアプリ サービス プラン名を作成し、適切な場所を選択します*
    - **[Application Insights]**: オフ
    - **[Microsoft アプリ ID とパスワード]**: *アプリ ID とパスワードを自動作成します*

1. ボットが作成されるのを待ちます (待っている間、右上にベルのような通知アイコンが表示されます)。 次に、デプロイが完了したという通知で、**[リソースに移動]** をクリックします (または、ホーム ページで **リソース グループ** をクリックし、Web アプリ ボットを作成したリソース グループを開いてクリックします)。

1. ボットの左側のペインで、 **[設定]** を探し、 **[Web チャットでテストする]** をクリックして、ボットが **Hello and welcome!** というメッセージを表示するまで待ちます。(初期化には数秒かかることがあります)。

1. テスト チャット インターフェイスを使用して、ボットがナレッジ ベースから期待どおりに質問に回答することを確認します。 たとえば、* 「ホテルをキャンセルしたいです」* を送信してみます。

ボットを使ってみます。 FAQ にある質問に対しては正確に回答できるはずですが、トレーニングされていない質問を解釈する機能は限られています。 いつでも Language Studio ポータルを使用して、ナレッジベースを編集し、改善して、再公開することができます。

## <a name="learn-more"></a>詳細情報

- 質問応答サービスの詳細については、[こちらのドキュメント](https://docs.microsoft.com/azure/cognitive-services/language-service/question-answering/overview)を参照してください。
- Microsoft Bot Service の詳細については、[Azure Bot Service のページ](https://azure.microsoft.com/services/bot-service/)を参照してください。
